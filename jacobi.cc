#include "equations.h"

namespace mhd
{
  
  template <int dim>
  void MHDequations<dim>::JacobiM(double v[])
  {
    double iRh, iRh2, Uk, p, GAMMAmo, Ec1, Ec2, Ec3, E1, E2, E3;

    // using shorter notation for old solution
    // order of the variables is following: rho, v(3), B(3), U, J(3)

    iRh = 1.0 / v[0];
    iRh2 = iRh*iRh;
    Uk = iRh*(v[1] * v[1] + v[2] * v[2] + v[3] * v[3]);
    p = GAMMA*(v[7] - (v[4] * v[4] + v[5] * v[5] + v[6] * v[6]) - Uk);
    GAMMAmo = GAMMA - 1.0;
    Ec1 = (v[3] * v[5] - v[2] * v[6])*iRh;
    Ec2 = (v[1] * v[6] - v[3] * v[4])*iRh;
    Ec3 = (v[2] * v[4] - v[1] * v[5])*iRh;
    E1 = Ec1 + ETA*v[8];
    E2 = Ec2 + ETA*v[9];
    E3 = Ec3 + ETA*v[10];

    switch(dim){
    case 3:
    //A[2][0][0] = 0;
    //A[2][0][1] = 0;
    //A[2][0][2] = 0;
    A[2][0][3] = 1;
    //A[2][0][4] = 0;
    //A[2][0][5] = 0;
    //A[2][0][6] = 0;
    //A[2][0][7] = 0;
    //A[2][0][8] = 0;
    //A[2][0][9] = 0;
    //A[2][0][10] = 0;

    A[2][1][0] = -v[1] * v[3]*iRh2;
    A[2][1][1] = v[3] * iRh;
    //A[2][1][2] = 0;
    A[2][1][3] = v[1] * iRh;
    A[2][1][4] = -v[6];
    //A[2][1][5] = 0;
    A[2][1][6] = -v[4];
    //A[2][1][7] = 0;
    //A[2][1][8] = 0;
    //A[2][1][9] = 0;
    //A[2][1][10] = 0;

    A[2][2][0] = -v[2] * v[3]*iRh2;
    //A[2][2][1] = 0;
    A[2][2][2] = v[3] * iRh;
    A[2][2][3] = v[2] * iRh;
    //A[2][2][4] = 0;
    A[2][2][5] = -v[6];
    A[2][2][6] = -v[5];
    //A[2][2][7] = 0;
    //A[2][2][8] = 0;
    //A[2][2][9] = 0;
    //A[2][2][10] = 0;

    A[2][3][0] = -v[3] * v[3] * iRh2 + (GAMMAmo*Uk)*.5*iRh;
    A[2][3][1] = -GAMMAmo*v[1]*iRh;
    A[2][3][2] = -GAMMAmo*v[2]*iRh;
    A[2][3][3] = (2 - GAMMAmo)*v[3]*iRh;
    A[2][3][4] = (1 - GAMMAmo)*v[4];
    A[2][3][5] = (1 - GAMMAmo)*v[5];
    A[2][3][6] = -GAMMA*v[6];
    A[2][3][7] = 0.5*GAMMAmo;
    //A[2][3][8] = 0;
    //A[2][3][9] = 0;
    //A[2][3][10] = 0;

    A[2][4][0] = Ec2*iRh;
    A[2][4][1] =-v[6] * iRh;
    //A[2][4][2] = 0;
    A[2][4][3] = v[4] * iRh;
    A[2][4][4] = v[3] * iRh;
    //A[2][4][5] = 0;
    A[2][4][6] =-v[1] * iRh;
    //A[2][4][7] = 0;
    //A[2][4][8] = 0;
    A[2][4][9] = -ETA;
    //A[2][4][10] = 0;

    A[2][5][0] = -Ec1*iRh;
    //A[2][5][1] = 0;
    A[2][5][2] =-v[6] * iRh;
    A[2][5][3] = v[5] * iRh;
    //A[2][5][4] = 0;
    A[2][5][5] = v[3] * iRh;
    A[2][5][6] =-v[2] * iRh;
    //A[2][5][7] = 0;
    A[2][5][8] = ETA;
    //A[2][5][9] = 0;
    //A[2][5][10] = 0;

    //A[2][6][0] = 0;
    //A[2][6][1] = 0;
    //A[2][6][2] = 0;
    //A[2][6][3] = 0;
    //A[2][6][4] = 0;
    //A[2][6][5] = 0;
    //A[2][6][6] = 0;
    //A[2][6][7] = 0;
    //A[2][6][8] = 0;
    //A[2][6][9] = 0;
    //A[2][6][10] = 0;

    A[2][7][0] = 2 * iRh*(v[4]*Ec2 - v[5]*Ec1) + (GAMMAmo*Uk - (Uk + p))*v[3]*iRh2;
    A[2][7][1] = -2*v[4]*v[6]*iRh - 2*GAMMAmo*v[1]*v[3]*iRh2;
    A[2][7][2] = -2*v[5]*v[6]*iRh - 2*GAMMAmo*v[2]*v[3]*iRh2;
    A[2][7][3] = 2 * (v[4] * v[4] + v[5] * v[5])*iRh + 2*v[3] * GAMMAmo*v[3]*iRh2 + (Uk + p)*iRh;
    A[2][7][4] = -2 * GAMMA*v[4] * v[3] * iRh + 2 * (v[4] * v[3]*iRh - E2);
    A[2][7][5] = -2 * GAMMA*v[5] * v[3] * iRh + 2 * (v[5] * v[3]*iRh + E1);
    A[2][7][6] = -2 * GAMMA*v[6] * v[3] * iRh + 2 * (-v[4] * v[1] - v[5] * v[2])*iRh;
    A[2][7][7] = GAMMA*v[3]*iRh;
    A[2][7][8] = 2 * ETA*v[5];
    A[2][7][9] = -2 * ETA*v[4];
    //A[2][7][10] = 0;

    //A[2][8][0] = 0;
    //A[2][8][1] = 0;
    //A[2][8][2] = 0;
    //A[2][8][3] = 0;
    //A[2][8][4] = 0;
    A[2][8][5] = 1;
    //A[2][8][6] = 0;
    //A[2][8][7] = 0;
    //A[2][8][8] = 0;
    //A[2][8][9] = 0;
    //A[2][8][10] = 0;

    //A[2][9][0] = 0;
    //A[2][9][1] = 0;
    //A[2][9][2] = 0;
    //A[2][9][3] = 0;
    A[2][9][4] = -1;
    //A[2][9][5] = 0;
    //A[2][9][6] = 0;
    //A[2][9][7] = 0;
    //A[2][9][8] = 0;
    //A[2][9][9] = 0;
    //A[2][9][10] = 0;

    //A[2][10][0] = 0;
    //A[2][10][1] = 0;
    //A[2][10][2] = 0;
    //A[2][10][3] = 0;
    //A[2][10][4] = 0;
    //A[2][10][5] = 0;
    //A[2][10][6] = 0;
    //A[2][10][7] = 0;
    //A[2][10][8] = 0;
    //A[2][10][9] = 0;
    //A[2][10][10] = 0;
    
    //A[2][11][0] = 0; // div B
    //A[2][11][1] = 0;
    //A[2][11][2] = 0;
    //A[2][11][3] = 0;
    //A[2][11][4] = 0;
    //A[2][11][5] = 0;
    A[2][11][6] = 1;
    //A[2][11][7] = 0;
    //A[2][11][8] = 0;
    //A[2][11][9] = 0;
    //A[2][11][10] = 0;
    
    case 2:
    //A[1][0][0] = 0;
    //A[1][0][1] = 0;
    A[1][0][2] = 1;
    //A[1][0][3] = 0;
    //A[1][0][4] = 0;
    //A[1][0][5] = 0;
    //A[1][0][6] = 0;
    //A[1][0][7] = 0;
    //A[1][0][8] = 0;
    //A[1][0][9] = 0;
    //A[1][0][10] = 0;

    A[1][1][0] = -v[1] * v[2]*iRh2;
    A[1][1][1] = v[2] * iRh;
    A[1][1][2] = v[1] * iRh;
    //A[1][1][3] = 0;
    A[1][1][4] = -v[5];
    A[1][1][5] = -v[4];
    //A[1][1][6] = 0;
    //A[1][1][7] = 0;
    //A[1][1][8] = 0;
    //A[1][1][9] = 0;
    //A[1][1][10] = 0;

    A[1][2][0] = -v[2] * v[2] * iRh2 + GAMMAmo*Uk*.5*iRh;
    A[1][2][1] = -GAMMAmo*v[1]*iRh;
    A[1][2][2] = (2 - GAMMAmo)*v[2]*iRh;
    A[1][2][3] = -GAMMAmo*v[3]*iRh;
    A[1][2][4] = (1 - GAMMAmo)*v[4];
    A[1][2][5] = -GAMMA*v[5];
    A[1][2][6] = (1 - GAMMAmo)*v[6];
    A[1][2][7] = 0.5*GAMMAmo;
    //A[1][2][8] = 0;
    //A[1][2][9] = 0;
    //A[1][2][10] = 0;

    A[1][3][0] = -v[2] * v[3]*iRh2;
    //A[1][3][1] = 0;
    A[1][3][2] = v[3] * iRh;
    A[1][3][3] = v[2] * iRh;
    //A[1][3][4] = 0;
    A[1][3][5] = -v[6];
    A[1][3][6] = -v[5];
    //A[1][3][7] = 0;
    //A[1][3][8] = 0;
    //A[1][3][9] = 0;
    //A[1][3][10] = 0;

    A[1][4][0] = -Ec3*iRh;
    A[1][4][1] =-v[5] * iRh;
    A[1][4][2] = v[4] * iRh;
    //A[1][4][3] = 0;
    A[1][4][4] = v[2] * iRh;
    A[1][4][5] =-v[1] * iRh;
    //A[1][4][6] = 0;
    //A[1][4][7] = 0;
    //A[1][4][8] = 0;
    //A[1][4][9] = 0;
    A[1][4][10] = ETA;

    //A[1][5][0] = 0;
    //A[1][5][1] = 0;
    //A[1][5][2] = 0;
    //A[1][5][3] = 0;
    //A[1][5][4] = 0;
    //A[1][5][5] = 0;
    //A[1][5][6] = 0;
    //A[1][5][7] = 0;
    //A[1][5][8] = 0;
    //A[1][5][9] = 0;
    //A[1][5][10] = 0;

    A[1][6][0] = Ec1*iRh;
    //A[1][6][1] = 0;
    A[1][6][2] = v[6] * iRh;
    A[1][6][3] =-v[5] * iRh;
    //A[1][6][4] = 0;
    A[1][6][5] =-v[3] * iRh;
    A[1][6][6] = v[2] * iRh;
    //A[1][6][7] = 0;
    A[1][6][8] = -ETA;
    //A[1][6][9] = 0;
    //A[1][6][10] = 0;

    A[1][7][0] = 2 * iRh*(-v[4]*Ec3 + v[6]*Ec1) + (GAMMAmo*Uk - (Uk + p))*v[2]*iRh2;
    A[1][7][1] = -2 * v[4] * v[5] * iRh - 2 * GAMMAmo*v[1] * v[2] * iRh2;
    A[1][7][2] = 2 * (v[4] * v[4] + v[6] * v[6])*iRh - 2*v[2] * GAMMAmo*v[2]*iRh2 + (Uk + p)*iRh;
    A[1][7][3] = -2 * v[5] * v[6] * iRh - 2 * GAMMAmo*v[2] * v[3] * iRh2;
    A[1][7][4] = -2 * GAMMA*v[4] * v[2] * iRh + 2 * (v[4] * v[2]*iRh + E3);
    A[1][7][5] = -2 * GAMMA*v[5] * v[2] * iRh + 2 * (-v[4] * v[1] - v[6] * v[3])*iRh;
    A[1][7][6] = -2 * GAMMA*v[6] * v[2] * iRh + 2 * (v[6] * v[2]*iRh - E1);
    A[1][7][7] = GAMMA*v[2]*iRh;
    A[1][7][8] = -2 * ETA*v[6];
    //A[1][7][9] = 0;
    A[1][7][10] = 2 * ETA*v[4];

    //A[1][8][0] = 0;
    //A[1][8][1] = 0;
    //A[1][8][2] = 0;
    //A[1][8][3] = 0;
    //A[1][8][4] = 0;
    //A[1][8][5] = 0;
    A[1][8][6] = -1;
    //A[1][8][7] = 0;
    //A[1][8][8] = 0;
    //A[1][8][9] = 0;
    //A[1][8][10] = 0;

    //A[1][9][0] = 0;
    //A[1][9][1] = 0;
    //A[1][9][2] = 0;
    //A[1][9][3] = 0;
    //A[1][9][4] = 0;
    //A[1][9][5] = 0;
    //A[1][9][6] = 0;
    //A[1][9][7] = 0;
    //A[1][9][8] = 0;
    //A[1][9][9] = 0;
    //A[1][9][10] = 0;

    //A[1][10][0] = 0;
    //A[1][10][1] = 0;
    //A[1][10][2] = 0;
    //A[1][10][3] = 0;
    A[1][10][4] = 1;
    //A[1][10][5] = 0;
    //A[1][10][6] = 0;
    //A[1][10][7] = 0;
    //A[1][10][8] = 0;
    //A[1][10][9] = 0;
    //A[1][10][10] = 0;
    
    //A[1][11][0] = 0;  // div B
    //A[1][11][1] = 0;
    //A[1][11][2] = 0;
    //A[1][11][3] = 0;
    //A[1][11][4] = 0;
    A[1][11][5] = 1;
    //A[1][11][6] = 0;
    //A[1][11][7] = 0;
    //A[1][11][8] = 0;
    //A[1][11][9] = 0;
    //A[1][11][10] = 0;

    case 1:
    //A[0][0][0] = 0;
    A[0][0][1] = 1;
    //A[0][0][2] = 0;
    //A[0][0][3] = 0;
    //A[0][0][4] = 0;
    //A[0][0][5] = 0;
    //A[0][0][6] = 0;
    //A[0][0][7] = 0;
    //A[0][0][8] = 0;
    //A[0][0][9] = 0;
    //A[0][0][10] = 0;

    A[0][1][0] = -(v[1] * v[1] * iRh2) + GAMMAmo*Uk*.5*iRh;
    A[0][1][1] = (2  - GAMMAmo)*v[1]*iRh;
    A[0][1][2] = -GAMMAmo*v[2]*iRh;
    A[0][1][3] = -GAMMAmo*v[3]*iRh;
    A[0][1][4] = -GAMMA*v[4];
    A[0][1][5] = (1 - GAMMAmo)*v[5];
    A[0][1][6] = (1 - GAMMAmo)*v[6];
    A[0][1][7] = 0.5*GAMMAmo;
    //A[0][1][8] = 0;
    //A[0][1][9] = 0;
    //A[0][1][10] = 0;

    A[0][2][0] = -v[1] * v[2]*iRh2;
    A[0][2][1] = v[2] * iRh;
    A[0][2][2] = v[1] * iRh;
    //A[0][2][3] = 0;
    A[0][2][4] = -v[5];
    A[0][2][5] = -v[4];
    //A[0][2][6] = 0;
    //A[0][2][7] = 0;
    //A[0][2][8] = 0;
    //A[0][2][9] = 0;
    //A[0][2][10] = 0;

    A[0][3][0] = -v[1] * v[3]*iRh2;
    A[0][3][1] = v[3] * iRh;
    //A[0][3][2] = 0;
    A[0][3][3] = v[1] * iRh;
    A[0][3][4] = -v[6];
    //A[0][3][5] = 0;
    A[0][3][6] = -v[4];
    //A[0][3][7] = 0;
    //A[0][3][8] = 0;
    //A[0][3][9] = 0;
    //A[0][3][10] = 0;

    //A[0][4][0] = 0;
    //A[0][4][1] = 0;
    //A[0][4][2] = 0;
    //A[0][4][3] = 0;
    //A[0][4][4] = 0;
    //A[0][4][5] = 0;
    //A[0][4][6] = 0;
    //A[0][4][7] = 0;
    //A[0][4][8] = 0;
    //A[0][4][9] = 0;
    //A[0][4][10] = 0;

    A[0][5][0] = Ec3*iRh;
    A[0][5][1] = v[5] * iRh;
    A[0][5][2] =-v[4] * iRh;
    //A[0][5][3] = 0;
    A[0][5][4] =-v[2] * iRh;
    A[0][5][5] = v[1] * iRh;
    //A[0][5][6] = 0;
    //A[0][5][7] = 0;
    //A[0][5][8] = 0;
    //A[0][5][9] = 0;
    A[0][5][10] = -ETA;

    A[0][6][0] = -Ec2*iRh;
    A[0][6][1] = v[6] * iRh;
    //A[0][6][2] = 0;
    A[0][6][3] = -v[4] * iRh;
    A[0][6][4] = -v[3] * iRh;
    //A[0][6][5] = 0;
    A[0][6][6] = v[1] * iRh;
    //A[0][6][7] = 0;
    //A[0][6][8] = 0;
    A[0][6][9] = ETA;
    //A[0][6][10] = 0;

    A[0][7][0] = 2 * iRh*(v[5]*Ec3 - v[6]*Ec2) +  (GAMMAmo*Uk* - (Uk + p)) *v[1]*iRh2;
    A[0][7][1] = 2 * (v[5] * v[5] + v[6] * v[6])*iRh - 2*v[1] * GAMMAmo*v[1]*iRh2 + (Uk + p)*iRh;
    A[0][7][2] = -2 * v[4] * v[5] * iRh - v[1] * 2 * GAMMAmo*v[2]*iRh2;
    A[0][7][3] = -2 * v[4] * v[6] * iRh - v[1] * 2 * GAMMAmo*v[3]*iRh2;
    A[0][7][4] = -2 * GAMMA*v[4] * v[1] * iRh + 2 * (-v[5] * v[2] - v[6] * v[3])*iRh;
    A[0][7][5] = -2 * GAMMA*v[5] * v[1] * iRh + 2 * (v[5] * v[1]*iRh - E3);
    A[0][7][6] = -2 * GAMMA*v[6] * v[1] * iRh + 2 * (v[6] * v[1]*iRh + E2);
    A[0][7][7] = GAMMA*v[1]*iRh;
    //A[0][7][8] = 0;
    A[0][7][9] = 2 * ETA*v[6];
    A[0][7][10] = -2 * ETA*v[5];

    //A[0][8][0] = 0;
    //A[0][8][1] = 0;
    //A[0][8][2] = 0;
    //A[0][8][3] = 0;
    //A[0][8][4] = 0;
    //A[0][8][5] = 0;
    //A[0][8][6] = 0;
    //A[0][8][7] = 0;
    //A[0][8][8] = 0;
    //A[0][8][9] = 0;
    //A[0][8][10] = 0;

    //A[0][9][0] = 0;
    //A[0][9][1] = 0;
    //A[0][9][2] = 0;
    //A[0][9][3] = 0;
    //A[0][9][4] = 0;
    //A[0][9][5] = 0;
    A[0][9][6] = 1;
    //A[0][9][7] = 0;
    //A[0][9][8] = 0;
    //A[0][9][9] = 0;
    //A[0][9][10] = 0;

    //A[0][10][0] = 0;
    //A[0][10][1] = 0;
    //A[0][10][2] = 0;
    //A[0][10][3] = 0;
    //A[0][10][4] = 0;
    A[0][10][5] = -1;
    //A[0][10][6] = 0;
    //A[0][10][7] = 0;
    //A[0][10][8] = 0;
    //A[0][10][9] = 0;
    //A[0][10][10] = 0;
    
    //A[0][11][0] = 0;  // div B
    //A[0][11][1] = 0;
    //A[0][11][2] = 0;
    //A[0][11][3] = 0;
    A[0][11][4] = 1;
    //A[0][11][5] = 0;
    //A[0][11][6] = 0;
    //A[0][11][7] = 0;
    //A[0][11][8] = 0;
    //A[0][11][9] = 0;
    //A[0][11][10] = 0;
    } // end of switch 
  }
  
  // Derivative (x,y,z) of the Jacobi matrix - Newton-Raphson linearization
  template <int dim>
  void MHDequations<dim>::dxA(double v[], double dv[][Nv])
  {
    double iRh, iRh2,iRh3;

    iRh = 1.0 / v[0];
    iRh2 = iRh*iRh;
    iRh3 = iRh2*iRh;
    switch(dim){
    case 1:
//     B[0][0]=0;
//     B[0][1]=0;
//     B[0][2]=0;
//     B[0][3]=0;
//     B[0][4]=0;
//     B[0][5]=0;
//     B[0][6]=0;
//     B[0][7]=0;
//     B[0][8]=0;
//     B[0][9]=0;
//     B[0][10]=0;

    B[1][0]=(dv[0][0]*(-(-3+GAMMA)*v[1]*v[1]-(-1+GAMMA)*(v[2]*v[2]+v[3]*v[3]))+(-3+GAMMA)*v[0]*v[1]*dv[0][1]+(-1+GAMMA)*v[0]*(v[2]*dv[0][2]+v[3]*dv[0][3]))*iRh2*iRh;
    B[1][1]=((-3+GAMMA)*(dv[0][0]*v[1]-v[0]*dv[0][1]))*iRh2;
    B[1][2]=((-1+GAMMA)*(dv[0][0]*v[2]-v[0]*dv[0][2]))*iRh2;
    B[1][3]=((-1+GAMMA)*(dv[0][0]*v[3]-v[0]*dv[0][3]))*iRh2;
    B[1][4]=-GAMMA*dv[0][4];
    B[1][5]=-(-2+GAMMA)*dv[0][5];
    B[1][6]=-(-2+GAMMA)*dv[0][6];
//    B[1][7]=0;
//    B[1][8]=0;
//    B[1][9]=0;
//    B[1][10]=0;

    B[2][0]=(-v[0]*v[2]*dv[0][1]+v[1]*(2*dv[0][0]*v[2]-v[0]*dv[0][2]))*iRh2*iRh;
    B[2][1]=(-dv[0][0]*v[2]+v[0]*dv[0][2])*iRh2;
    B[2][2]=(-dv[0][0]*v[1]+v[0]*dv[0][1])*iRh2;
//    B[2][3]=0;
    B[2][4]=-dv[0][5];
    B[2][5]=-dv[0][4];
//     B[2][6]=0;
//     B[2][7]=0;
//     B[2][8]=0;
//     B[2][9]=0;
//     B[2][10]=0;

    B[3][0]=(-v[0]*v[3]*dv[0][1]+v[1]*(2*dv[0][0]*v[3]-v[0]*dv[0][3]))*iRh2*iRh;
    B[3][1]=(-dv[0][0]*v[3]+v[0]*dv[0][3])*iRh2;
//    B[3][2]=0;
    B[3][3]=(-dv[0][0]*v[1]+v[0]*dv[0][1])*iRh2;
    B[3][4]=-dv[0][6];
//    B[3][5]=0;
    B[3][6]=-dv[0][4];
//     B[3][7]=0;
//     B[3][8]=0;
//     B[3][9]=0;
//     B[3][10]=0;

//     B[4][0]=0;
//     B[4][1]=0;
//     B[4][2]=0;
//     B[4][3]=0;
//     B[4][4]=0;
//     B[4][5]=0;
//     B[4][6]=0;
//     B[4][7]=0;
//     B[4][8]=0;
//     B[4][9]=0;
//     B[4][10]=0;

    B[5][0]=(v[0]*(v[2]*dv[0][4]-v[1]*dv[0][5])+v[5]*(2*dv[0][0]*v[1]-v[0]*dv[0][1])+v[4]*(-2*dv[0][0]*v[2]+v[0]*dv[0][2]))*iRh2*iRh;
    B[5][1]=(-dv[0][0]*v[5]+v[0]*dv[0][5])*iRh2;
    B[5][2]=(dv[0][0]*v[4]-v[0]*dv[0][4])*iRh2;
//    B[5][3]=0;
    B[5][4]=(dv[0][0]*v[2]-v[0]*dv[0][2])*iRh2;
    B[5][5]=(-dv[0][0]*v[1]+v[0]*dv[0][1])*iRh2;
//     B[5][6]=0;
//     B[5][7]=0;
//     B[5][8]=0;
//     B[5][9]=0;
//     B[5][10]=0;

    B[6][0]=(v[0]*(v[3]*dv[0][4]-v[1]*dv[0][6])+v[6]*(2*dv[0][0]*v[1]-v[0]*dv[0][1])+v[4]*(-2*dv[0][0]*v[3]+v[0]*dv[0][3]))*iRh2*iRh;
    B[6][1]=(-dv[0][0]*v[6]+v[0]*dv[0][6])*iRh2;
    B[6][2]=0;
    B[6][3]=(dv[0][0]*v[4]-v[0]*dv[0][4])*iRh2;
    B[6][4]=(dv[0][0]*v[3]-v[0]*dv[0][3])*iRh2;
//    B[6][5]=0;
    B[6][6]=(-dv[0][0]*v[1]+v[0]*dv[0][1])*iRh2;
//     B[6][7]=0;
//     B[6][8]=0;
//     B[6][9]=0;
//     B[6][10]=0;

    B[7][0]=iRh2*iRh2*(GAMMA*v[0]*(2*v[7]*dv[0][0]-dv[0][7]*v[0])*v[1]+4*dv[0][0]*v[0]*v[6]*v[6]*v[1]-2*dv[0][0]*GAMMA*v[0]*v[6]*v[6]*v[1]+6*dv[0][0]*v[1]*v[1]*v[1]-6*dv[0][0]*GAMMA*v[1]*v[1]*v[1]+6*dv[0][0]*v[1]*v[2]*v[2]-6*dv[0][0]*GAMMA*v[1]*v[2]*v[2]+6*dv[0][0]*v[1]*v[3]*v[3]-6*dv[0][0]*GAMMA*v[1]*v[3]*v[3]+2*v[0]*v[0]*v[6]*v[3]*dv[0][4]+2*v[0]*v[0]*v[5]*(v[2]*dv[0][4]+(-2+GAMMA)*v[1]*dv[0][5])-4*v[0]*v[0]*v[6]*v[1]*dv[0][6]+2*GAMMA*v[0]*v[0]*v[6]*v[1]*dv[0][6]-v[7]*GAMMA*v[0]*v[0]*dv[0][1]-2*v[0]*v[0]*v[6]*v[6]*dv[0][1]+GAMMA*v[0]*v[0]*v[6]*v[6]*dv[0][1]-6*v[0]*v[1]*v[1]*dv[0][1]+6*GAMMA*v[0]*v[1]*v[1]*dv[0][1]-2*v[0]*v[2]*v[2]*dv[0][1]+2*GAMMA*v[0]*v[2]*v[2]*dv[0][1]-2*v[0]*v[3]*v[3]*dv[0][1]+2*GAMMA*v[0]*v[3]*v[3]*dv[0][1]+GAMMA*v[0]*v[4]*v[4]*(-2*dv[0][0]*v[1]+v[0]*dv[0][1])+(-2+GAMMA)*v[0]*v[5]*v[5]*(-2*dv[0][0]*v[1]+v[0]*dv[0][1])-4*v[0]*v[1]*v[2]*dv[0][2]+4*GAMMA*v[0]*v[1]*v[2]*dv[0][2]+4*(-1+GAMMA)*v[0]*v[1]*v[3]*dv[0][3]+2*v[0]*v[4]*(v[0]*(GAMMA*v[1]*dv[0][4]+v[2]*dv[0][5]+v[3]*dv[0][6])+v[5]*(-2*dv[0][0]*v[2]+v[0]*dv[0][2])+v[6]*(-2*dv[0][0]*v[3]+v[0]*dv[0][3])));
    B[7][1]=iRh2*iRh*(GAMMA*v[0]*(-v[7]*dv[0][0]+dv[0][7]*v[0])+dv[0][0]*GAMMA*v[0]*v[4]*v[4]+dv[0][0]*(-2+GAMMA)*v[0]*v[5]*v[5]-2*dv[0][0]*v[0]*v[6]*v[6]+dv[0][0]*GAMMA*v[0]*v[6]*v[6]-6*dv[0][0]*v[1]*v[1]+6*dv[0][0]*GAMMA*v[1]*v[1]-2*dv[0][0]*v[2]*v[2]+2*dv[0][0]*GAMMA*v[2]*v[2]-2*dv[0][0]*v[3]*v[3]+2*dv[0][0]*GAMMA*v[3]*v[3]-2*GAMMA*v[0]*v[0]*v[4]*dv[0][4]-2*(-2+GAMMA)*v[0]*v[0]*v[5]*dv[0][5]+4*v[0]*v[0]*v[6]*dv[0][6]-2*GAMMA*v[0]*v[0]*v[6]*dv[0][6]+6*v[0]*v[1]*dv[0][1]-6*GAMMA*v[0]*v[1]*dv[0][1]+2*v[0]*v[2]*dv[0][2]-2*GAMMA*v[0]*v[2]*dv[0][2]-2*(-1+GAMMA)*v[0]*v[3]*dv[0][3]);
    B[7][2]=-((2*(v[0]*v[0]*v[5]*dv[0][4]+v[0]*v[4]*(-dv[0][0]*v[5]+v[0]*dv[0][5])+(-1+GAMMA)*(v[0]*v[2]*dv[0][1]+v[1]*(-2*dv[0][0]*v[2]+v[0]*dv[0][2]))))*iRh2*iRh);
    B[7][3]=-((2*(v[0]*v[0]*v[6]*dv[0][4]+v[0]*v[4]*(-dv[0][0]*v[6]+v[0]*dv[0][6])+(-1+GAMMA)*(v[0]*v[3]*dv[0][1]+v[1]*(-2*dv[0][0]*v[3]+v[0]*dv[0][3]))))*iRh2*iRh);
    B[7][4]=-((2*(-dv[0][0]*v[6]*v[3]+GAMMA*v[0]*v[1]*dv[0][4]+v[0]*v[2]*dv[0][5]+v[0]*v[3]*dv[0][6]+GAMMA*v[4]*(-dv[0][0]*v[1]+v[0]*dv[0][1])+v[5]*(-dv[0][0]*v[2]+v[0]*dv[0][2])+v[0]*v[6]*dv[0][3]))*iRh2);
    B[7][5]=(2*(-v[0]*(v[2]*dv[0][4]+(-2+GAMMA)*v[1]*dv[0][5]+ETA*v[0]*dv[0][10])+(-2+GAMMA)*v[5]*(dv[0][0]*v[1]-v[0]*dv[0][1])+v[4]*(dv[0][0]*v[2]-v[0]*dv[0][2])))*iRh2;
    B[7][6]=(2*(v[0]*(-v[3]*dv[0][4]-(-2+GAMMA)*v[1]*dv[0][6]+ETA*v[0]*dv[0][9])+(-2+GAMMA)*v[6]*(dv[0][0]*v[1]-v[0]*dv[0][1])+v[4]*(dv[0][0]*v[3]-v[0]*dv[0][3])))*iRh2;
    B[7][7]=(-dv[0][0]*GAMMA*v[1]+GAMMA*v[0]*dv[0][1])*iRh2;
//     B[7][8]=0;
    B[7][9]=2*ETA*dv[0][6];
    B[7][10]=-2*ETA*dv[0][5];

//     B[8][0]=0;
//     B[8][1]=0;
//     B[8][2]=0;
//     B[8][3]=0;
//     B[8][4]=0;
//     B[8][5]=0;
//     B[8][6]=0;
//     B[8][7]=0;
//     B[8][8]=0;
//     B[8][9]=0;
//     B[8][10]=0;

//     B[9][0]=0;
//     B[9][1]=0;
//     B[9][2]=0;
//     B[9][3]=0;
//     B[9][4]=0;
//     B[9][5]=0;
//     B[9][6]=0;
//     B[9][7]=0;
//     B[9][8]=0;
//     B[9][9]=0;
//     B[9][10]=0;

//     B[10][0]=0;
//     B[10][1]=0;
//     B[10][2]=0;
//     B[10][3]=0;
//     B[10][4]=0;
//     B[10][5]=0;
//     B[10][6]=0;
//     B[10][7]=0;
//     B[10][8]=0;
//     B[10][9]=0;
//     B[10][10]=0;
    break;
    
    case 2:
//     B[0][0]=0;
//     B[0][1]=0;
//     B[0][2]=0;
//     B[0][3]=0;
//     B[0][4]=0;
//     B[0][5]=0;
//     B[0][6]=0;
//     B[0][7]=0;
//     B[0][8]=0;
//     B[0][9]=0;
//     B[0][10]=0;

    B[1][0]=(2*dv[1][0]*v[1]*v[2]+dv[0][0]*(-(-3+GAMMA)*v[1]*v[1]-(-1+GAMMA)*(v[2]*v[2]+v[3]*v[3]))+v[0]*((-3+GAMMA)*v[1]*dv[0][1]+(-1+GAMMA)*v[2]*dv[0][2]+(-1+GAMMA)*v[3]*dv[0][3]-v[2]*dv[1][1]-v[1]*dv[1][2]))*iRh2*iRh;
    B[1][1]=(dv[0][0]*(-3+GAMMA)*v[1]-dv[1][0]*v[2]-(-3+GAMMA)*v[0]*dv[0][1]+v[0]*dv[1][2])*iRh2;
    B[1][2]=(-dv[1][0]*v[1]+dv[0][0]*(-1+GAMMA)*v[2]+(v[0]-GAMMA*v[0])*dv[0][2]+v[0]*dv[1][1])*iRh2;
    B[1][3]=((-1+GAMMA)*(dv[0][0]*v[3]-v[0]*dv[0][3]))*iRh2;
    B[1][4]=-GAMMA*dv[0][4]-dv[1][5];
    B[1][5]=-(-2+GAMMA)*dv[0][5]-dv[1][4];
    B[1][6]=-(-2+GAMMA)*dv[0][6];
//     B[1][7]=0;
//     B[1][8]=0;
//     B[1][9]=0;
//     B[1][10]=0;

    B[2][0]=iRh2*iRh*(2*dv[0][0]*v[1]*v[2]-dv[1][0]*((-1+GAMMA)*v[1]*v[1]+(-3+GAMMA)*v[2]*v[2]+(-1+GAMMA)*v[3]*v[3])-v[0]*v[2]*dv[0][1]-v[0]*v[1]*dv[0][2]+(-1+GAMMA)*v[0]*v[1]*dv[1][1]+(-3+GAMMA)*v[0]*v[2]*dv[1][2]+(-1+GAMMA)*v[0]*v[3]*dv[1][3]);
    B[2][1]=(dv[1][0]*(-1+GAMMA)*v[1]-dv[0][0]*v[2]+v[0]*dv[0][2]+(v[0]-GAMMA*v[0])*dv[1][1])*iRh2;
    B[2][2]=(-dv[0][0]*v[1]+dv[1][0]*(-3+GAMMA)*v[2]+v[0]*dv[0][1]-(-3+GAMMA)*v[0]*dv[1][2])*iRh2;
    B[2][3]=((-1+GAMMA)*(dv[1][0]*v[3]-v[0]*dv[1][3]))*iRh2;
    B[2][4]=-dv[0][5]-(-2+GAMMA)*dv[1][4];
    B[2][5]=-dv[0][4]-GAMMA*dv[1][5];
    B[2][6]=-(-2+GAMMA)*dv[1][6];
//     B[2][7]=0;
//     B[2][8]=0;
//     B[2][9]=0;
//     B[2][10]=0;

    B[3][0]=(2*(dv[0][0]*v[1]+dv[1][0]*v[2])*v[3]-v[0]*(v[1]*dv[0][3]+v[3]*(dv[0][1]+dv[1][2])+v[2]*dv[1][3]))*iRh2*iRh;
    B[3][1]=(-dv[0][0]*v[3]+v[0]*dv[0][3])*iRh2;
    B[3][2]=(-dv[1][0]*v[3]+v[0]*dv[1][3])*iRh2;
    B[3][3]=(-dv[0][0]*v[1]-dv[1][0]*v[2]+v[0]*(dv[0][1]+dv[1][2]))*iRh2;
    B[3][4]=-dv[0][6];
    B[3][5]=-dv[1][6];
    B[3][6]=-dv[0][4]-dv[1][5];
//     B[3][7]=0;
//     B[3][8]=0;
//     B[3][9]=0;
//     B[3][10]=0;

    B[4][0]=(-v[0]*v[2]*dv[1][4]+v[0]*v[1]*dv[1][5]+v[5]*(-2*dv[1][0]*v[1]+v[0]*dv[1][1])+v[4]*(2*dv[1][0]*v[2]-v[0]*dv[1][2]))*iRh2*iRh;
    B[4][1]=(dv[1][0]*v[5]-v[0]*dv[1][5])*iRh2;
    B[4][2]=(-dv[1][0]*v[4]+v[0]*dv[1][4])*iRh2;
//     B[4][3]=0;
    B[4][4]=(-dv[1][0]*v[2]+v[0]*dv[1][2])*iRh2;
    B[4][5]=(dv[1][0]*v[1]-v[0]*dv[1][1])*iRh2;
//     B[4][6]=0;
//     B[4][7]=0;
//     B[4][8]=0;
//     B[4][9]=0;
//     B[4][10]=0;

    B[5][0]=(v[0]*(v[2]*dv[0][4]-v[1]*dv[0][5])+v[5]*(2*dv[0][0]*v[1]-v[0]*dv[0][1])+v[4]*(-2*dv[0][0]*v[2]+v[0]*dv[0][2]))*iRh2*iRh;
    B[5][1]=(-dv[0][0]*v[5]+v[0]*dv[0][5])*iRh2;
    B[5][2]=(dv[0][0]*v[4]-v[0]*dv[0][4])*iRh2;
//     B[5][3]=0;
    B[5][4]=(dv[0][0]*v[2]-v[0]*dv[0][2])*iRh2;
    B[5][5]=(-dv[0][0]*v[1]+v[0]*dv[0][1])*iRh2;
//     B[5][6]=0;
//     B[5][7]=0;
//     B[5][8]=0;
//     B[5][9]=0;
//     B[5][10]=0;

    B[6][0]=(-2*dv[1][0]*v[5]*v[3]+v[0]*v[3]*dv[0][4]-v[0]*v[1]*dv[0][6]+v[4]*(-2*dv[0][0]*v[3]+v[0]*dv[0][3])+v[0]*v[3]*dv[1][5]-v[0]*v[2]*dv[1][6]+v[6]*(2*(dv[0][0]*v[1]+dv[1][0]*v[2])-v[0]*(dv[0][1]+dv[1][2]))+v[0]*v[5]*dv[1][3])*iRh2*iRh;
    B[6][1]=(-dv[0][0]*v[6]+v[0]*dv[0][6])*iRh2;
    B[6][2]=(-dv[1][0]*v[6]+v[0]*dv[1][6])*iRh2;
    B[6][3]=(dv[0][0]*v[4]+dv[1][0]*v[5]-v[0]*(dv[0][4]+dv[1][5]))*iRh2;
    B[6][4]=(dv[0][0]*v[3]-v[0]*dv[0][3])*iRh2;
    B[6][5]=(dv[1][0]*v[3]-v[0]*dv[1][3])*iRh2;
    B[6][6]=(-dv[0][0]*v[1]-dv[1][0]*v[2]+v[0]*(dv[0][1]+dv[1][2]))*iRh2;
//     B[6][7]=0;
//     B[6][8]=0;
//     B[6][9]=0;
//     B[6][10]=0;

    B[7][0]=iRh2*iRh2*(GAMMA*v[0]*(2*v[7]*dv[0][0]-dv[0][7]*v[0])*v[1]+4*dv[0][0]*v[0]*v[6]*v[6]*v[1]-2*dv[0][0]*GAMMA*v[0]*v[6]*v[6]*v[1]+6*dv[0][0]*v[1]*v[1]*v[1]-6*dv[0][0]*GAMMA*v[1]*v[1]*v[1]+2*v[7]*dv[1][0]*GAMMA*v[0]*v[2]-dv[1][7]*GAMMA*v[0]*v[0]*v[2]+4*dv[1][0]*v[0]*v[6]*v[6]*v[2]-2*dv[1][0]*GAMMA*v[0]*v[6]*v[6]*v[2]+6*dv[1][0]*v[1]*v[1]*v[2]-6*dv[1][0]*GAMMA*v[1]*v[1]*v[2]+6*dv[0][0]*v[1]*v[2]*v[2]-6*dv[0][0]*GAMMA*v[1]*v[2]*v[2]+6*dv[1][0]*v[2]*v[2]*v[2]-6*dv[1][0]*GAMMA*v[2]*v[2]*v[2]+6*dv[0][0]*v[1]*v[3]*v[3]-6*dv[0][0]*GAMMA*v[1]*v[3]*v[3]+6*dv[1][0]*v[2]*v[3]*v[3]-6*dv[1][0]*GAMMA*v[2]*v[3]*v[3]+2*v[0]*v[0]*v[6]*v[3]*dv[0][4]-4*v[0]*v[0]*v[6]*v[1]*dv[0][6]+2*GAMMA*v[0]*v[0]*v[6]*v[1]*dv[0][6]-v[7]*GAMMA*v[0]*v[0]*dv[0][1]-2*v[0]*v[0]*v[6]*v[6]*dv[0][1]+GAMMA*v[0]*v[0]*v[6]*v[6]*dv[0][1]-6*v[0]*v[1]*v[1]*dv[0][1]+6*GAMMA*v[0]*v[1]*v[1]*dv[0][1]-2*v[0]*v[2]*v[2]*dv[0][1]+2*GAMMA*v[0]*v[2]*v[2]*dv[0][1]-2*v[0]*v[3]*v[3]*dv[0][1]+2*GAMMA*v[0]*v[3]*v[3]*dv[0][1]-4*v[0]*v[1]*v[2]*dv[0][2]+4*GAMMA*v[0]*v[1]*v[2]*dv[0][2]-4*v[0]*v[1]*v[3]*dv[0][3]+4*GAMMA*v[0]*v[1]*v[3]*dv[0][3]+2*v[0]*v[0]*v[6]*v[3]*dv[1][5]-4*v[0]*v[0]*v[6]*v[2]*dv[1][6]+2*GAMMA*v[0]*v[0]*v[6]*v[2]*dv[1][6]-4*v[0]*v[1]*v[2]*dv[1][1]+4*GAMMA*v[0]*v[1]*v[2]*dv[1][1]+2*v[0]*v[4]*(v[6]*(-2*dv[0][0]*v[3]+v[0]*dv[0][3])+v[0]*(GAMMA*v[1]*dv[0][4]+v[3]*dv[0][6]+v[2]*(dv[0][5]+(-2+GAMMA)*dv[1][4])+v[1]*dv[1][5])+v[5]*(-2*(dv[1][0]*v[1]+dv[0][0]*v[2])+v[0]*(dv[0][2]+dv[1][1])))-v[7]*GAMMA*v[0]*v[0]*dv[1][2]-2*v[0]*v[0]*v[6]*v[6]*dv[1][2]+GAMMA*v[0]*v[0]*v[6]*v[6]*dv[1][2]-2*v[0]*v[1]*v[1]*dv[1][2]+2*GAMMA*v[0]*v[1]*v[1]*dv[1][2]-6*v[0]*v[2]*v[2]*dv[1][2]+6*GAMMA*v[0]*v[2]*v[2]*dv[1][2]-2*v[0]*v[3]*v[3]*dv[1][2]+2*GAMMA*v[0]*v[3]*v[3]*dv[1][2]+v[0]*v[4]*v[4]*(-2*dv[0][0]*GAMMA*v[1]-2*dv[1][0]*(-2+GAMMA)*v[2]+GAMMA*v[0]*dv[0][1]+(-2+GAMMA)*v[0]*dv[1][2])+v[0]*v[5]*v[5]*(-2*dv[0][0]*(-2+GAMMA)*v[1]-2*dv[1][0]*GAMMA*v[2]+(-2+GAMMA)*v[0]*dv[0][1]+GAMMA*v[0]*dv[1][2])+4*(-1+GAMMA)*v[0]*v[2]*v[3]*dv[1][3]+2*v[0]*v[5]*(v[0]*(v[1]*((-2+GAMMA)*dv[0][5]+dv[1][4])+v[2]*(dv[0][4]+GAMMA*dv[1][5])+v[3]*dv[1][6])+v[6]*(-2*dv[1][0]*v[3]+v[0]*dv[1][3])));
    B[7][1]=iRh2*iRh*(GAMMA*v[0]*(-v[7]*dv[0][0]+dv[0][7]*v[0])+dv[0][0]*GAMMA*v[0]*v[4]*v[4]+dv[0][0]*(-2+GAMMA)*v[0]*v[5]*v[5]-2*dv[0][0]*v[0]*v[6]*v[6]+dv[0][0]*GAMMA*v[0]*v[6]*v[6]-6*dv[0][0]*v[1]*v[1]+6*dv[0][0]*GAMMA*v[1]*v[1]-4*dv[1][0]*v[1]*v[2]+4*dv[1][0]*GAMMA*v[1]*v[2]-2*dv[0][0]*v[2]*v[2]+2*dv[0][0]*GAMMA*v[2]*v[2]-2*dv[0][0]*v[3]*v[3]+2*dv[0][0]*GAMMA*v[3]*v[3]+4*v[0]*v[0]*v[6]*dv[0][6]-2*GAMMA*v[0]*v[0]*v[6]*dv[0][6]+6*v[0]*v[1]*dv[0][1]-6*GAMMA*v[0]*v[1]*dv[0][1]+2*v[0]*v[2]*dv[0][2]-2*GAMMA*v[0]*v[2]*dv[0][2]+2*v[0]*v[3]*dv[0][3]-2*GAMMA*v[0]*v[3]*dv[0][3]-2*v[0]*v[0]*v[5]*((-2+GAMMA)*dv[0][5]+dv[1][4])-2*v[0]*v[4]*(-dv[1][0]*v[5]+v[0]*(GAMMA*dv[0][4]+dv[1][5]))+2*v[0]*v[2]*dv[1][1]-2*GAMMA*v[0]*v[2]*dv[1][1]-2*(-1+GAMMA)*v[0]*v[1]*dv[1][2]);
    B[7][2]=iRh2*iRh*(GAMMA*v[0]*(-v[7]*dv[1][0]+dv[1][7]*v[0])+dv[1][0]*(-2+GAMMA)*v[0]*v[4]*v[4]+dv[1][0]*GAMMA*v[0]*v[5]*v[5]-2*dv[1][0]*v[0]*v[6]*v[6]+dv[1][0]*GAMMA*v[0]*v[6]*v[6]-2*dv[1][0]*v[1]*v[1]+2*dv[1][0]*GAMMA*v[1]*v[1]-4*dv[0][0]*v[1]*v[2]+4*dv[0][0]*GAMMA*v[1]*v[2]-6*dv[1][0]*v[2]*v[2]+6*dv[1][0]*GAMMA*v[2]*v[2]-2*dv[1][0]*v[3]*v[3]+2*dv[1][0]*GAMMA*v[3]*v[3]+2*v[0]*v[2]*dv[0][1]-2*GAMMA*v[0]*v[2]*dv[0][1]+2*v[0]*v[1]*dv[0][2]-2*GAMMA*v[0]*v[1]*dv[0][2]-2*v[0]*v[4]*(-dv[0][0]*v[5]+v[0]*(dv[0][5]+(-2+GAMMA)*dv[1][4]))-2*v[0]*v[0]*v[5]*(dv[0][4]+GAMMA*dv[1][5])+4*v[0]*v[0]*v[6]*dv[1][6]-2*GAMMA*v[0]*v[0]*v[6]*dv[1][6]+2*v[0]*v[1]*dv[1][1]-2*GAMMA*v[0]*v[1]*dv[1][1]+6*v[0]*v[2]*dv[1][2]-6*GAMMA*v[0]*v[2]*dv[1][2]-2*(-1+GAMMA)*v[0]*v[3]*dv[1][3]);
    B[7][3]=iRh2*iRh*2*(2*(-1+GAMMA)*(dv[0][0]*v[1]+dv[1][0]*v[2])*v[3]+v[0]*v[4]*(dv[0][0]*v[6]-v[0]*dv[0][6])+v[0]*v[5]*(dv[1][0]*v[6]-v[0]*dv[1][6])+v[0]*(-v[0]*v[6]*(dv[0][4]+dv[1][5])-(-1+GAMMA)*(v[1]*dv[0][3]+v[3]*(dv[0][1]+dv[1][2])+v[2]*dv[1][3])));
    B[7][4]=(1/(v[0]*v[0]))*2*(dv[0][0]*v[6]*v[3]-v[0]*(GAMMA*v[1]*dv[0][4]+v[2]*dv[0][5])-v[0]*v[3]*dv[0][6]-v[0]*v[6]*dv[0][3]+2*v[0]*v[2]*dv[1][4]-GAMMA*v[0]*v[2]*dv[1][4]-v[0]*v[1]*dv[1][5]+ETA*v[0]*v[0]*dv[1][10]+v[5]*(dv[1][0]*v[1]+dv[0][0]*v[2]-v[0]*(dv[0][2]+dv[1][1]))+v[4]*(dv[0][0]*GAMMA*v[1]+dv[1][0]*(-2+GAMMA)*v[2]-GAMMA*v[0]*dv[0][1]-(-2+GAMMA)*v[0]*dv[1][2]));
    B[7][5]=-(1/(v[0]*v[0]))*2*(-dv[1][0]*v[6]*v[3]+v[0]*(ETA*v[0]*dv[0][10]+v[1]*((-2+GAMMA)*dv[0][5]+dv[1][4])+v[2]*(dv[0][4]+GAMMA*dv[1][5]))+v[0]*v[3]*dv[1][6]+v[4]*(-dv[1][0]*v[1]-dv[0][0]*v[2]+v[0]*(dv[0][2]+dv[1][1]))+v[5]*(-dv[0][0]*(-2+GAMMA)*v[1]-dv[1][0]*GAMMA*v[2]+(-2+GAMMA)*v[0]*dv[0][1]+GAMMA*v[0]*dv[1][2])+v[0]*v[6]*dv[1][3]);
    B[7][6]=(1/(v[0]*v[0]))*2*(dv[1][0]*v[5]*v[3]-v[0]*v[3]*dv[0][4]+2*v[0]*v[1]*dv[0][6]-GAMMA*v[0]*v[1]*dv[0][6]+ETA*v[0]*v[0]*dv[0][9]+v[4]*(dv[0][0]*v[3]-v[0]*dv[0][3])-v[0]*v[3]*dv[1][5]+2*v[0]*v[2]*dv[1][6]-GAMMA*v[0]*v[2]*dv[1][6]-ETA*v[0]*v[0]*dv[1][8]+(-2+GAMMA)*v[6]*(dv[0][0]*v[1]+dv[1][0]*v[2]-v[0]*(dv[0][1]+dv[1][2]))-v[0]*v[5]*dv[1][3]);
    B[7][7]=(GAMMA*(-dv[0][0]*v[1]-dv[1][0]*v[2]+v[0]*(dv[0][1]+dv[1][2])))*iRh2;
    B[7][8]=-2*ETA*dv[1][6];
    B[7][9]=2*ETA*dv[0][6];
    B[7][10]=2*ETA*(-dv[0][5]+dv[1][4]);

//     B[8][0]=0;
//     B[8][1]=0;
//     B[8][2]=0;
//     B[8][3]=0;
//     B[8][4]=0;
//     B[8][5]=0;
//     B[8][6]=0;
//     B[8][7]=0;
//     B[8][8]=0;
//     B[8][9]=0;
//     B[8][10]=0;

//     B[9][0]=0;
//     B[9][1]=0;
//     B[9][2]=0;
//     B[9][3]=0;
//     B[9][4]=0;
//     B[9][5]=0;
//     B[9][6]=0;
//     B[9][7]=0;
//     B[9][8]=0;
//     B[9][9]=0;
//     B[9][10]=0;

//     B[10][0]=0;
//     B[10][1]=0;
//     B[10][2]=0;
//     B[10][3]=0;
//     B[10][4]=0;
//     B[10][5]=0;
//     B[10][6]=0;
//     B[10][7]=0;
//     B[10][8]=0;
//     B[10][9]=0;
//     B[10][10]=0;
    break;
    
    case 3:
//     B[0][0]=0;
//     B[0][1]=0;
//     B[0][2]=0;
//     B[0][3]=0;
//     B[0][4]=0;
//     B[0][5]=0;
//     B[0][6]=0;
//     B[0][7]=0;
//     B[0][8]=0;
//     B[0][9]=0;
//     B[0][10]=0;

    B[1][0]=iRh3*(2*v[1]*(dv[1][0]*v[2]+dv[2][0]*v[3])-dv[0][0]*((-3+GAMMA)*v[1]*v[1]+(-1+GAMMA)*(v[2]*v[2]+v[3]*v[3]))+(-3+GAMMA)*v[0]*v[1]*dv[0][1]-v[0]*(-(-1+GAMMA)*v[2]*dv[0][2]+v[2]*dv[1][1]+v[3]*(dv[0][3]-GAMMA*dv[0][3]+dv[2][1])+v[1]*(dv[1][2]+dv[2][3])));
    B[1][1]=(dv[0][0]*(-3+GAMMA)*v[1]-dv[1][0]*v[2]-dv[2][0]*v[3]+v[0]*(-(-3+GAMMA)*dv[0][1]+dv[1][2]+dv[2][3]))*iRh2;
    B[1][2]=(-dv[1][0]*v[1]+dv[0][0]*(-1+GAMMA)*v[2]+(v[0]-GAMMA*v[0])*dv[0][2]+v[0]*dv[1][1])*iRh2;
    B[1][3]=(-dv[2][0]*v[1]+dv[0][0]*(-1+GAMMA)*v[3]+(v[0]-GAMMA*v[0])*dv[0][3]+v[0]*dv[2][1])*iRh2;
    B[1][4]=-GAMMA*dv[0][4]-dv[1][5]-dv[2][6];
    B[1][5]=-(-2+GAMMA)*dv[0][5]-dv[1][4];
    B[1][6]=-(-2+GAMMA)*dv[0][6]-dv[2][4];
//     B[1][7]=0;
//     B[1][8]=0;
//     B[1][9]=0;
//     B[1][10]=0;

    B[2][0]=-iRh3*(-2*v[2]*(dv[0][0]*v[1]+dv[2][0]*v[3])+dv[1][0]*((-1+GAMMA)*v[1]*v[1]+(-3+GAMMA)*v[2]*v[2]+(-1+GAMMA)*v[3]*v[3])+v[0]*(v[2]*dv[0][1]+v[1]*(dv[0][2]-(-1+GAMMA)*dv[1][1])-(-3+GAMMA)*v[2]*dv[1][2]+v[3]*dv[1][3]+v[3]*(-GAMMA*dv[1][3]+dv[2][2])+v[2]*dv[2][3]));
    B[2][1]=(dv[1][0]*(-1+GAMMA)*v[1]-dv[0][0]*v[2]+v[0]*dv[0][2]+(v[0]-GAMMA*v[0])*dv[1][1])*iRh2;
    B[2][2]=(-dv[0][0]*v[1]+dv[1][0]*(-3+GAMMA)*v[2]-dv[2][0]*v[3]+v[0]*(dv[0][1]-(-3+GAMMA)*dv[1][2]+dv[2][3]))*iRh2;
    B[2][3]=(-dv[2][0]*v[2]+dv[1][0]*(-1+GAMMA)*v[3]+(v[0]-GAMMA*v[0])*dv[1][3]+v[0]*dv[2][2])*iRh2;
    B[2][4]=-dv[0][5]-(-2+GAMMA)*dv[1][4];
    B[2][5]=-dv[0][4]-GAMMA*dv[1][5]-dv[2][6];
    B[2][6]=-(-2+GAMMA)*dv[1][6]-dv[2][5];
//     B[2][7]=0;
//     B[2][8]=0;
//     B[2][9]=0;
//     B[2][10]=0;

    B[3][0]=iRh3*(-dv[2][0]*(-1+GAMMA)*(v[1]*v[1]+v[2]*v[2])+2*(dv[0][0]*v[1]+dv[1][0]*v[2])*v[3]-dv[2][0]*(-3+GAMMA)*v[3]*v[3]-v[0]*(v[1]*dv[0][3]+v[3]*(dv[0][1]+dv[1][2])+v[2]*dv[1][3])+(-1+GAMMA)*v[0]*v[1]*dv[2][1]+(-1+GAMMA)*v[0]*v[2]*dv[2][2]+(-3+GAMMA)*v[0]*v[3]*dv[2][3]);
    B[3][1]=(dv[2][0]*(-1+GAMMA)*v[1]-dv[0][0]*v[3]+v[0]*dv[0][3]+(v[0]-GAMMA*v[0])*dv[2][1])*iRh2;
    B[3][2]=(dv[2][0]*(-1+GAMMA)*v[2]-dv[1][0]*v[3]+v[0]*dv[1][3]+(v[0]-GAMMA*v[0])*dv[2][2])*iRh2;
    B[3][3]=(-dv[0][0]*v[1]-dv[1][0]*v[2]+dv[2][0]*(-3+GAMMA)*v[3]+v[0]*(dv[0][1]+dv[1][2]-(-3+GAMMA)*dv[2][3]))*iRh2;
    B[3][4]=-dv[0][6]-(-2+GAMMA)*dv[2][4];
    B[3][5]=-dv[1][6]-(-2+GAMMA)*dv[2][5];
    B[3][6]=-dv[0][4]-dv[1][5]-GAMMA*dv[2][6];
//     B[3][7]=0;
//     B[3][8]=0;
//     B[3][9]=0;
//     B[3][10]=0;

    B[4][0]=(2*dv[2][0]*v[4]*v[3]+v[2]*(2*dv[1][0]*v[4]-v[0]*dv[1][4])+v[0]*v[1]*dv[1][5]+v[5]*(-2*dv[1][0]*v[1]+v[0]*dv[1][1])-v[0]*v[4]*dv[1][2]-v[0]*v[3]*dv[2][4]+v[0]*v[1]*dv[2][6]+v[6]*(-2*dv[2][0]*v[1]+v[0]*dv[2][1])-v[0]*v[4]*dv[2][3])*iRh3;
    B[4][1]=(dv[1][0]*v[5]+dv[2][0]*v[6]-v[0]*(dv[1][5]+dv[2][6]))*iRh2;
    B[4][2]=(-dv[1][0]*v[4]+v[0]*dv[1][4])*iRh2;
    B[4][3]=(-dv[2][0]*v[4]+v[0]*dv[2][4])*iRh2;
    B[4][4]=(-dv[1][0]*v[2]-dv[2][0]*v[3]+v[0]*(dv[1][2]+dv[2][3]))*iRh2;
    B[4][5]=(dv[1][0]*v[1]-v[0]*dv[1][1])*iRh2;
    B[4][6]=(dv[2][0]*v[1]-v[0]*dv[2][1])*iRh2;
//     B[4][7]=0;
//     B[4][8]=0;
//     B[4][9]=0;
//     B[4][10]=0;

    B[5][0]=(-2*dv[2][0]*v[6]*v[2]+v[0]*v[2]*dv[0][4]-v[0]*v[1]*dv[0][5]+v[4]*(-2*dv[0][0]*v[2]+v[0]*dv[0][2])-v[0]*v[3]*dv[2][5]+v[0]*v[2]*dv[2][6]+v[0]*v[6]*dv[2][2]+v[5]*(2*(dv[0][0]*v[1]+dv[2][0]*v[3])-v[0]*(dv[0][1]+dv[2][3])))*iRh3;
    B[5][1]=(-dv[0][0]*v[5]+v[0]*dv[0][5])*iRh2;
    B[5][2]=(dv[0][0]*v[4]+dv[2][0]*v[6]-v[0]*(dv[0][4]+dv[2][6]))*iRh2;
    B[5][3]=(-dv[2][0]*v[5]+v[0]*dv[2][5])*iRh2;
    B[5][4]=(dv[0][0]*v[2]-v[0]*dv[0][2])*iRh2;
    B[5][5]=(-dv[0][0]*v[1]-dv[2][0]*v[3]+v[0]*(dv[0][1]+dv[2][3]))*iRh2;
    B[5][6]=(dv[2][0]*v[2]-v[0]*dv[2][2])*iRh2;
//     B[5][7]=0;
//     B[5][8]=0;
//     B[5][9]=0;
//     B[5][10]=0;

    B[6][0]=(-2*dv[1][0]*v[5]*v[3]+v[0]*v[3]*dv[0][4]-v[0]*v[1]*dv[0][6]+v[4]*(-2*dv[0][0]*v[3]+v[0]*dv[0][3])+v[0]*v[3]*dv[1][5]-v[0]*v[2]*dv[1][6]+v[6]*(2*(dv[0][0]*v[1]+dv[1][0]*v[2])-v[0]*(dv[0][1]+dv[1][2]))+v[0]*v[5]*dv[1][3])*iRh3;
    B[6][1]=(-dv[0][0]*v[6]+v[0]*dv[0][6])*iRh2;
    B[6][2]=(-dv[1][0]*v[6]+v[0]*dv[1][6])*iRh2;
    B[6][3]=(dv[0][0]*v[4]+dv[1][0]*v[5]-v[0]*(dv[0][4]+dv[1][5]))*iRh2;
    B[6][4]=(dv[0][0]*v[3]-v[0]*dv[0][3])*iRh2;
    B[6][5]=(dv[1][0]*v[3]-v[0]*dv[1][3])*iRh2;
    B[6][6]=(-dv[0][0]*v[1]-dv[1][0]*v[2]+v[0]*(dv[0][1]+dv[1][2]))*iRh2;
//     B[6][7]=0;
//     B[6][8]=0;
//     B[6][9]=0;
//     B[6][10]=0;

    B[7][0]=iRh2*iRh2*(GAMMA*v[0]*(2*v[7]*dv[0][0]-dv[0][7]*v[0])*v[1]+4*dv[0][0]*v[0]*v[6]*v[6]*v[1]-2*dv[0][0]*GAMMA*v[0]*v[6]*v[6]*v[1]+6*dv[0][0]*v[1]*v[1]*v[1]-6*dv[0][0]*GAMMA*v[1]*v[1]*v[1]+2*v[7]*dv[1][0]*GAMMA*v[0]*v[2]-dv[1][7]*GAMMA*v[0]*v[0]*v[2]+4*dv[1][0]*v[0]*v[6]*v[6]*v[2]-2*dv[1][0]*GAMMA*v[0]*v[6]*v[6]*v[2]+6*dv[1][0]*v[1]*v[1]*v[2]-6*dv[1][0]*GAMMA*v[1]*v[1]*v[2]+6*dv[0][0]*v[1]*v[2]*v[2]-6*dv[0][0]*GAMMA*v[1]*v[2]*v[2]+6*dv[1][0]*v[2]*v[2]*v[2]-6*dv[1][0]*GAMMA*v[2]*v[2]*v[2]+2*v[7]*dv[2][0]*GAMMA*v[0]*v[3]-dv[2][7]*GAMMA*v[0]*v[0]*v[3]-2*dv[2][0]*GAMMA*v[0]*v[6]*v[6]*v[3]+6*dv[2][0]*v[1]*v[1]*v[3]-6*dv[2][0]*GAMMA*v[1]*v[1]*v[3]+6*dv[2][0]*v[2]*v[2]*v[3]-6*dv[2][0]*GAMMA*v[2]*v[2]*v[3]+6*dv[0][0]*v[1]*v[3]*v[3]-6*dv[0][0]*GAMMA*v[1]*v[3]*v[3]+6*dv[1][0]*v[2]*v[3]*v[3]-6*dv[1][0]*GAMMA*v[2]*v[3]*v[3]+6*dv[2][0]*v[3]*v[3]*v[3]-6*dv[2][0]*GAMMA*v[3]*v[3]*v[3]+2*v[0]*v[0]*v[6]*v[3]*dv[0][4]-4*v[0]*v[0]*v[6]*v[1]*dv[0][6]+2*GAMMA*v[0]*v[0]*v[6]*v[1]*dv[0][6]-v[7]*GAMMA*v[0]*v[0]*dv[0][1]-2*v[0]*v[0]*v[6]*v[6]*dv[0][1]+GAMMA*v[0]*v[0]*v[6]*v[6]*dv[0][1]-6*v[0]*v[1]*v[1]*dv[0][1]+6*GAMMA*v[0]*v[1]*v[1]*dv[0][1]-2*v[0]*v[2]*v[2]*dv[0][1]+2*GAMMA*v[0]*v[2]*v[2]*dv[0][1]-2*v[0]*v[3]*v[3]*dv[0][1]+2*GAMMA*v[0]*v[3]*v[3]*dv[0][1]-4*v[0]*v[1]*v[2]*dv[0][2]+4*GAMMA*v[0]*v[1]*v[2]*dv[0][2]-4*v[0]*v[1]*v[3]*dv[0][3]+4*GAMMA*v[0]*v[1]*v[3]*dv[0][3]+2*v[0]*v[0]*v[6]*v[3]*dv[1][5]-4*v[0]*v[0]*v[6]*v[2]*dv[1][6]+2*GAMMA*v[0]*v[0]*v[6]*v[2]*dv[1][6]-4*v[0]*v[1]*v[2]*dv[1][1]+4*GAMMA*v[0]*v[1]*v[2]*dv[1][1]-v[7]*GAMMA*v[0]*v[0]*dv[1][2]-2*v[0]*v[0]*v[6]*v[6]*dv[1][2]+GAMMA*v[0]*v[0]*v[6]*v[6]*dv[1][2]-2*v[0]*v[1]*v[1]*dv[1][2]+2*GAMMA*v[0]*v[1]*v[1]*dv[1][2]-6*v[0]*v[2]*v[2]*dv[1][2]+6*GAMMA*v[0]*v[2]*v[2]*dv[1][2]-2*v[0]*v[3]*v[3]*dv[1][2]+2*GAMMA*v[0]*v[3]*v[3]*dv[1][2]-4*v[0]*v[2]*v[3]*dv[1][3]+4*GAMMA*v[0]*v[2]*v[3]*dv[1][3]+2*v[0]*v[0]*v[6]*v[1]*dv[2][4]+2*v[0]*v[0]*v[6]*v[2]*dv[2][5]+2*GAMMA*v[0]*v[0]*v[6]*v[3]*dv[2][6]-4*v[0]*v[1]*v[3]*dv[2][1]+4*GAMMA*v[0]*v[1]*v[3]*dv[2][1]+2*v[0]*v[4]*(v[5]*(-2*(dv[1][0]*v[1]+dv[0][0]*v[2])+v[0]*(dv[0][2]+dv[1][1]))+v[0]*(GAMMA*v[1]*dv[0][4]+v[2]*dv[0][5]+(-2+GAMMA)*v[2]*dv[1][4]+v[3]*(dv[0][6]+(-2+GAMMA)*dv[2][4])+v[1]*(dv[1][5]+dv[2][6]))+v[6]*(-2*(dv[2][0]*v[1]+dv[0][0]*v[3])+v[0]*(dv[0][3]+dv[2][1])))-4*v[0]*v[2]*v[3]*dv[2][2]+4*GAMMA*v[0]*v[2]*v[3]*dv[2][2]+2*v[0]*v[5]*(v[0]*(v[2]*dv[0][4]+v[1]*((-2+GAMMA)*dv[0][5]+dv[1][4])+GAMMA*v[2]*dv[1][5]+v[3]*(dv[1][6]-2*dv[2][5])+GAMMA*v[3]*dv[2][5]+v[2]*dv[2][6])+v[6]*(-2*(dv[2][0]*v[2]+dv[1][0]*v[3])+v[0]*(dv[1][3]+dv[2][2])))+v[0]*(-v[7]*GAMMA*v[0]+GAMMA*v[0]*v[6]*v[6]+2*(-1+GAMMA)*(v[1]*v[1]+v[2]*v[2]+3*v[3]*v[3]))*dv[2][3]+v[0]*v[5]*v[5]*(-2*dv[0][0]*(-2+GAMMA)*v[1]-2*dv[1][0]*GAMMA*v[2]-2*dv[2][0]*(-2+GAMMA)*v[3]+(-2+GAMMA)*v[0]*dv[0][1]+GAMMA*v[0]*dv[1][2]+(-2+GAMMA)*v[0]*dv[2][3])+v[0]*v[4]*v[4]*(-2*dv[0][0]*GAMMA*v[1]-2*(-2+GAMMA)*(dv[1][0]*v[2]+dv[2][0]*v[3])+GAMMA*v[0]*dv[0][1]+(-2+GAMMA)*v[0]*(dv[1][2]+dv[2][3])));
    B[7][1]=iRh3*(GAMMA*v[0]*(-v[7]*dv[0][0]+dv[0][7]*v[0])+dv[0][0]*GAMMA*v[0]*v[4]*v[4]+dv[0][0]*(-2+GAMMA)*v[0]*v[5]*v[5]-2*dv[0][0]*v[0]*v[6]*v[6]+dv[0][0]*GAMMA*v[0]*v[6]*v[6]-6*dv[0][0]*v[1]*v[1]+6*dv[0][0]*GAMMA*v[1]*v[1]-4*dv[1][0]*v[1]*v[2]+4*dv[1][0]*GAMMA*v[1]*v[2]-2*dv[0][0]*v[2]*v[2]+2*dv[0][0]*GAMMA*v[2]*v[2]-4*dv[2][0]*v[1]*v[3]+4*dv[2][0]*GAMMA*v[1]*v[3]-2*dv[0][0]*v[3]*v[3]+2*dv[0][0]*GAMMA*v[3]*v[3]+4*v[0]*v[0]*v[6]*dv[0][6]-2*GAMMA*v[0]*v[0]*v[6]*dv[0][6]+6*v[0]*v[1]*dv[0][1]-6*GAMMA*v[0]*v[1]*dv[0][1]+2*v[0]*v[2]*dv[0][2]-2*GAMMA*v[0]*v[2]*dv[0][2]+2*v[0]*v[3]*dv[0][3]-2*GAMMA*v[0]*v[3]*dv[0][3]-2*v[0]*v[0]*v[5]*((-2+GAMMA)*dv[0][5]+dv[1][4])+2*v[0]*v[2]*dv[1][1]-2*GAMMA*v[0]*v[2]*dv[1][1]+2*v[0]*v[1]*dv[1][2]-2*GAMMA*v[0]*v[1]*dv[1][2]-2*v[0]*v[0]*v[6]*dv[2][4]-2*v[0]*v[4]*(-dv[1][0]*v[5]-dv[2][0]*v[6]+v[0]*(GAMMA*dv[0][4]+dv[1][5]+dv[2][6]))+2*v[0]*v[3]*dv[2][1]-2*GAMMA*v[0]*v[3]*dv[2][1]-2*(-1+GAMMA)*v[0]*v[1]*dv[2][3]);
    B[7][2]=iRh3*(GAMMA*v[0]*(-v[7]*dv[1][0]+dv[1][7]*v[0])+dv[1][0]*(-2+GAMMA)*v[0]*v[4]*v[4]+dv[1][0]*GAMMA*v[0]*v[5]*v[5]-2*dv[1][0]*v[0]*v[6]*v[6]+dv[1][0]*GAMMA*v[0]*v[6]*v[6]-2*dv[1][0]*v[1]*v[1]+2*dv[1][0]*GAMMA*v[1]*v[1]-4*dv[0][0]*v[1]*v[2]+4*dv[0][0]*GAMMA*v[1]*v[2]-6*dv[1][0]*v[2]*v[2]+6*dv[1][0]*GAMMA*v[2]*v[2]-4*dv[2][0]*v[2]*v[3]+4*dv[2][0]*GAMMA*v[2]*v[3]-2*dv[1][0]*v[3]*v[3]+2*dv[1][0]*GAMMA*v[3]*v[3]+2*v[0]*v[2]*dv[0][1]-2*GAMMA*v[0]*v[2]*dv[0][1]+2*v[0]*v[1]*dv[0][2]-2*GAMMA*v[0]*v[1]*dv[0][2]-2*v[0]*v[4]*(-dv[0][0]*v[5]+v[0]*(dv[0][5]+(-2+GAMMA)*dv[1][4]))+4*v[0]*v[0]*v[6]*dv[1][6]-2*GAMMA*v[0]*v[0]*v[6]*dv[1][6]+2*v[0]*v[1]*dv[1][1]-2*GAMMA*v[0]*v[1]*dv[1][1]+6*v[0]*v[2]*dv[1][2]-6*GAMMA*v[0]*v[2]*dv[1][2]+2*v[0]*v[3]*dv[1][3]-2*GAMMA*v[0]*v[3]*dv[1][3]-2*v[0]*v[0]*v[6]*dv[2][5]-2*v[0]*v[5]*(-dv[2][0]*v[6]+v[0]*(dv[0][4]+GAMMA*dv[1][5]+dv[2][6]))+2*v[0]*v[3]*dv[2][2]-2*GAMMA*v[0]*v[3]*dv[2][2]-2*(-1+GAMMA)*v[0]*v[2]*dv[2][3]);
    B[7][3]=iRh3*(GAMMA*v[0]*(-v[7]*dv[2][0]+dv[2][7]*v[0])+dv[2][0]*(-2+GAMMA)*v[0]*v[4]*v[4]+dv[2][0]*(-2+GAMMA)*v[0]*v[5]*v[5]+dv[2][0]*GAMMA*v[0]*v[6]*v[6]-2*dv[2][0]*v[1]*v[1]+2*dv[2][0]*GAMMA*v[1]*v[1]-2*dv[2][0]*v[2]*v[2]+2*dv[2][0]*GAMMA*v[2]*v[2]-4*dv[0][0]*v[1]*v[3]+4*dv[0][0]*GAMMA*v[1]*v[3]-4*dv[1][0]*v[2]*v[3]+4*dv[1][0]*GAMMA*v[2]*v[3]-6*dv[2][0]*v[3]*v[3]+6*dv[2][0]*GAMMA*v[3]*v[3]-2*v[0]*v[0]*v[6]*dv[0][4]+2*v[0]*v[3]*dv[0][1]-2*GAMMA*v[0]*v[3]*dv[0][1]+2*v[0]*v[1]*dv[0][3]-2*GAMMA*v[0]*v[1]*dv[0][3]-2*v[0]*v[0]*v[6]*dv[1][5]+2*v[0]*v[3]*dv[1][2]-2*GAMMA*v[0]*v[3]*dv[1][2]+2*v[0]*v[2]*dv[1][3]-2*GAMMA*v[0]*v[2]*dv[1][3]-2*v[0]*v[4]*(-dv[0][0]*v[6]+v[0]*(dv[0][6]+(-2+GAMMA)*dv[2][4]))-2*v[0]*v[5]*(-dv[1][0]*v[6]+v[0]*dv[1][6]+(-2+GAMMA)*v[0]*dv[2][5])-2*GAMMA*v[0]*v[0]*v[6]*dv[2][6]+2*v[0]*v[1]*dv[2][1]-2*GAMMA*v[0]*v[1]*dv[2][1]+2*v[0]*v[2]*dv[2][2]-2*GAMMA*v[0]*v[2]*dv[2][2]-6*(-1+GAMMA)*v[0]*v[3]*dv[2][3]);
    B[7][4]=iRh2*2*(dv[2][0]*v[6]*v[1]+dv[0][0]*v[6]*v[3]-GAMMA*v[0]*v[1]*dv[0][4]-v[0]*v[2]*dv[0][5]-v[0]*v[3]*dv[0][6]-v[0]*v[6]*dv[0][3]+2*v[0]*v[2]*dv[1][4]-GAMMA*v[0]*v[2]*dv[1][4]-v[0]*v[1]*dv[1][5]+ETA*v[0]*v[0]*dv[1][10]+v[5]*(dv[1][0]*v[1]+dv[0][0]*v[2]-v[0]*(dv[0][2]+dv[1][1]))+2*v[0]*v[3]*dv[2][4]-GAMMA*v[0]*v[3]*dv[2][4]-v[0]*v[1]*dv[2][6]-ETA*v[0]*v[0]*dv[2][9]-v[0]*v[6]*dv[2][1]+v[4]*(dv[0][0]*GAMMA*v[1]+(-2+GAMMA)*(dv[1][0]*v[2]+dv[2][0]*v[3])-v[0]*(GAMMA*dv[0][1]+(-2+GAMMA)*(dv[1][2]+dv[2][3]))));
    B[7][5]=-iRh2*2*(-dv[2][0]*v[6]*v[2]-dv[1][0]*v[6]*v[3]+v[0]*v[2]*dv[0][4]-2*v[0]*v[1]*dv[0][5]+GAMMA*v[0]*v[1]*dv[0][5]+ETA*v[0]*v[0]*dv[0][10]+v[0]*v[1]*dv[1][4]+GAMMA*v[0]*v[2]*dv[1][5]+v[0]*v[3]*dv[1][6]+v[4]*(-dv[1][0]*v[1]-dv[0][0]*v[2]+v[0]*(dv[0][2]+dv[1][1]))+v[0]*v[6]*dv[1][3]-2*v[0]*v[3]*dv[2][5]+GAMMA*v[0]*v[3]*dv[2][5]+v[0]*v[2]*dv[2][6]-ETA*v[0]*v[0]*dv[2][8]+v[0]*v[6]*dv[2][2]+v[5]*(-dv[0][0]*(-2+GAMMA)*v[1]-dv[1][0]*GAMMA*v[2]-dv[2][0]*(-2+GAMMA)*v[3]+v[0]*((-2+GAMMA)*dv[0][1]+GAMMA*dv[1][2]+(-2+GAMMA)*dv[2][3])));
    B[7][6]=iRh2*2*(dv[2][0]*v[5]*v[2]+dv[1][0]*v[5]*v[3]-v[0]*v[3]*dv[0][4]+2*v[0]*v[1]*dv[0][6]-GAMMA*v[0]*v[1]*dv[0][6]+ETA*v[0]*v[0]*dv[0][9]-v[0]*v[3]*dv[1][5]+2*v[0]*v[2]*dv[1][6]-GAMMA*v[0]*v[2]*dv[1][6]-ETA*v[0]*v[0]*dv[1][8]-v[0]*v[5]*dv[1][3]-v[0]*v[1]*dv[2][4]-v[0]*v[2]*dv[2][5]-GAMMA*v[0]*v[3]*dv[2][6]+v[4]*(dv[2][0]*v[1]+dv[0][0]*v[3]-v[0]*(dv[0][3]+dv[2][1]))-v[0]*v[5]*dv[2][2]+v[6]*((-2+GAMMA)*(dv[0][0]*v[1]+dv[1][0]*v[2])+dv[2][0]*GAMMA*v[3]-(-2+GAMMA)*v[0]*(dv[0][1]+dv[1][2])-GAMMA*v[0]*dv[2][3]));
    B[7][7]=(GAMMA*(-dv[0][0]*v[1]-dv[1][0]*v[2]-dv[2][0]*v[3]+v[0]*(dv[0][1]+dv[1][2]+dv[2][3])))*iRh2;
    B[7][8]=2*ETA*(-dv[1][6]+dv[2][5]);
    B[7][9]=2*ETA*(dv[0][6]-dv[2][4]);
    B[7][10]=2*ETA*(-dv[0][5]+dv[1][4]);

//     B[8][0]=0;
//     B[8][1]=0;
//     B[8][2]=0;
//     B[8][3]=0;
//     B[8][4]=0;
//     B[8][5]=0;
//     B[8][6]=0;
//     B[8][7]=0;
//     B[8][8]=0;
//     B[8][9]=0;
//     B[8][10]=0;

//     B[9][0]=0;
//     B[9][1]=0;
//     B[9][2]=0;
//     B[9][3]=0;
//     B[9][4]=0;
//     B[9][5]=0;
//     B[9][6]=0;
//     B[9][7]=0;
//     B[9][8]=0;
//     B[9][9]=0;
//     B[9][10]=0;

//     B[10][0]=0;
//     B[10][1]=0;
//     B[10][2]=0;
//     B[10][3]=0;
//     B[10][4]=0;
//     B[10][5]=0;
//     B[10][6]=0;
//     B[10][7]=0;
//     B[10][8]=0;
//     B[10][9]=0;
//     B[10][10]=0;
    } // end of switch
  }
  
} // end of namespace mhd